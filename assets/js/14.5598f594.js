(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{494:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfUAAAD/CAMAAADfer/xAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAx9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEI2QzdBNzkwMkQwMTFFQkIzRTJBMThDRDhFMzk4RTYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEI2QzdBN0EwMkQwMTFFQkIzRTJBMThDRDhFMzk4RTYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowQjZDN0E3NzAyRDAxMUVCQjNFMkExOENEOEUzOThFNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowQjZDN0E3ODAyRDAxMUVCQjNFMkExOENEOEUzOThFNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuQKf88AAAGAUExURZKhq3eLlldYWeHv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"},495:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkkAAAEbCAMAAAD58OBnAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxNjNCQTIyQzA0ODUxMUVCQTcwRUYzMTdEMDlGNDJDRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxNjNCQTIyRDA0ODUxMUVCQTcwRUYzMTdEMDlGNDJDRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjE2M0JBMjJBMDQ4NTExRUJBNzBFRjMxN0QwOUY0MkNEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjE2M0JBMjJCMDQ4NTExRUJBNzBFRjMxN0QwOUY0MkNEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+TwbW6wAAAYBQTFRF78+uuOr+Z3aF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"},496:function(e,t,s){e.exports=s.p+"assets/img/v-pv.f0cbd603.png"},497:function(e,t,s){e.exports=s.p+"assets/img/pv-pvc.74b08dd6.png"},498:function(e,t,s){e.exports=s.p+"assets/img/storage-class.4d160b17.png"},674:function(e,t,s){"use strict";s.r(t);var r=s(11),n=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"kubernetes-存储设计"}},[e._v("Kubernetes 存储设计")]),e._v(" "),r("p",[e._v("Kubernetes 在规划持久化存储能力的时候，依然遵循着它的一贯设计哲学，用户负责以资源和声明式 API 来描述自己的意图，Kubernetes 负责根据用户意图来完成具体的操作。不过，就算仅仅是描述清楚用户的存储意图也并不是一件容易的事，相比起 Kubernetes 提供其他能力的资源，其内置的存储资源显得格外地复杂，甚至可以说是有些烦琐的。如果你是 Kubernetes 的拥趸，无法认同笔者对 Kubernetes 的批评，那不妨来看一看下列围绕着“Volume”所衍生出的概念，它们仅仅是 Kubernetes 存储相关的概念的一个子集而已，请你思考一下这些概念是否全都是必须的，是否还有整合的空间，是否有化繁为简的可能性：")]),e._v(" "),r("blockquote",[r("ul",[r("li",[r("strong",[e._v("概念")]),e._v("："),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Volume"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("PersistentVolume"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://v1-17.docs.kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims",target:"_blank",rel:"noopener noreferrer"}},[e._v("PersistentVolumeClaim"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Provisioner"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://v1-17.docs.kubernetes.io/docs/concepts/storage/storage-classes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("StorageClass"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://v1-17.docs.kubernetes.io/docs/concepts/storage/volume-snapshots/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Volume Snapshot"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://v1-17.docs.kubernetes.io/docs/concepts/storage/volume-snapshot-classes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Volume Snapshot Class"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/ephemeral-volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ephemeral Volumes"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://github.com/kubernetes/community/blob/master/contributors/devel/sig-storage/flexvolume.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("FlexVolume Driver"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://github.com/container-storage-interface/spec/blob/master/spec.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("Container Storage Interface"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://v1-17.docs.kubernetes.io/docs/concepts/storage/volume-pvc-datasource/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CSI Volume Cloning"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://v1-17.docs.kubernetes.io/docs/concepts/storage/storage-limits/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Volume Limits"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#volume-mode",target:"_blank",rel:"noopener noreferrer"}},[e._v("Volume Mode"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#volume-mode",target:"_blank",rel:"noopener noreferrer"}},[e._v("Access Modes"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/storage-capacity/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Storage Capacity"),r("OutboundLink")],1),e._v("……")]),e._v(" "),r("li",[r("strong",[e._v("操作")]),e._v("："),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#mount-options",target:"_blank",rel:"noopener noreferrer"}},[e._v("Mount"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#using",target:"_blank",rel:"noopener noreferrer"}},[e._v("Bind"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#using",target:"_blank",rel:"noopener noreferrer"}},[e._v("Use"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#provisioning",target:"_blank",rel:"noopener noreferrer"}},[e._v("Provision"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#claims-as-volumes",target:"_blank",rel:"noopener noreferrer"}},[e._v("Claim"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#reclaiming",target:"_blank",rel:"noopener noreferrer"}},[e._v("Reclaim"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#reserving-a-persistentvolume",target:"_blank",rel:"noopener noreferrer"}},[e._v("Reserve"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#expanding-persistent-volumes-claims",target:"_blank",rel:"noopener noreferrer"}},[e._v("Expand"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volume-pvc-datasource/#usage",target:"_blank",rel:"noopener noreferrer"}},[e._v("Clone"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/storage-capacity/#scheduling",target:"_blank",rel:"noopener noreferrer"}},[e._v("Schedule"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/storage-capacity/#rescheduling",target:"_blank",rel:"noopener noreferrer"}},[e._v("Reschedule"),r("OutboundLink")],1),e._v("……")])])]),e._v(" "),r("p",[e._v("诚然，Kubernetes 摆弄出如此多关于存储的术语概念，最重要的原因是存储技术本来就门类众多，为了尽可能多地兼容各种存储，Kubernetes 不得不预置了很多 In-Tree（意思是在 Kubernetes 的代码树里）插件来对接，让用户根据自己业务按需选择。同时，为了兼容那些不在预置范围内的需求场景，支持用户使用 FlexVolume 或者 CSI 来定制 Out-of-Tree（意思是在 Kubernetes 的代码树之外）的插件，实现更加丰富多样的存储能力。表 13-1 列出了部分 Kubernetes 目前提供的存储与扩展：")]),e._v(" "),r("div",{staticClass:"custom-block center"},[r("p",[e._v("表 13-1：Kubernetes 目前提供的存储")])]),e._v(" "),r("table",[r("thead",[r("tr",[r("th",[e._v("Temp")]),e._v(" "),r("th",[e._v("Ephemeral（Local）")]),e._v(" "),r("th",[e._v("Persistent（Network）")]),e._v(" "),r("th",[e._v("Extension")])])]),e._v(" "),r("tbody",[r("tr",[r("td",[e._v("EmptyDir")]),e._v(" "),r("td",[e._v("HostPath"),r("br"),e._v("GitRepo"),r("br"),e._v("Local"),r("br"),e._v("Secret"),r("br"),e._v("ConfigMap"),r("br"),e._v("DownwardAPI")]),e._v(" "),r("td",[e._v("AWS Elastic Block Store"),r("br"),e._v("GCE Persistent Disk"),r("br"),e._v("Azure Data Disk"),r("br"),e._v("Azure File Storage"),r("br"),e._v("vSphere"),r("br"),e._v("CephFS and RBD"),r("br"),e._v("GlusterFS"),r("br"),e._v("iSCSI"),r("br"),e._v("Cinder"),r("br"),e._v("Dell EMC ScaleIO"),r("br"),e._v("……")]),e._v(" "),r("td",[e._v("FlexVolume"),r("br"),e._v("CSI")])])])]),e._v(" "),r("p",[e._v("迫使 Kubernetes 存储设计成如此复杂，还有另外一个非技术层面的原因：Kubernetes 是一个工业级的、面向生产应用的容器编排系统，这意味着即使发现某些已存在的功能有更好的实现方式，直到旧版本被淘汰出生产环境以前，原本已支持的功能都不允许突然间被移除或者替换掉，否则，如果生产系统一更新版本，已有的功能就出现异常，那对产品累积良好的信誉是相当不利的。")]),e._v(" "),r("p",[e._v("为了兼容而导致的烦琐，在一定程度上可以被谅解，但这样的设计的确令 Kubernetes 的学习曲线变得更加陡峭。Kubernetes 官方文档的主要作用是参考手册，它并不会告诉你 Kubernetes 中各种概念的演化历程、版本发布新功能的时间线、改动的缘由与背景等信息。Kubernetes 的文档系统只会以“平坦”的方式来陈述所有目前可用的功能，这有利于熟练的管理员快速查询到关键信息，却不利于初学者去理解 Kubernetes 的设计思想，由于难以理解那些概念和操作的本意，往往只能死记硬背，也很难分辨出它们应该如何被“更正确”的使用。介绍 Kubernetes 设计理念的职责，只能由"),r("a",{attrs:{href:"https://kubernetes.io/blog/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes 官方的 Blog"),r("OutboundLink")],1),e._v("这类定位超越了帮助手册的信息渠道，或者其他非官方资料去完成。本节，笔者会以 Volume 概念从操作系统到 Docker，再到 Kubernetes 的演进历程为主线，去梳理前面提及的那些概念与操作，以此帮助大家理解 Kubernetes 的存储设计。")]),e._v(" "),r("h2",{attrs:{id:"mount-和-volume"}},[e._v("Mount 和 Volume")]),e._v(" "),r("p",[e._v("Mount 和 Volume 都是来源自操作系统的常用术语，Mount 是动词，表示将某个外部存储挂载到系统中，Volume 是名词，表示物理存储的逻辑抽象，目的是为物理存储提供有弹性的分割方式。容器源于对操作系统层的虚拟化，为了满足容器内生成数据的外部存储需求，也很自然地会将 Mount 和 Volume 的概念延拓至容器中。我们去了解容器存储的发展，不妨就以 Docker 的 Mount 操作为起始点。")]),e._v(" "),r("p",[e._v("目前，Docker 内建支持了三种挂载类型，分别是 Bind（"),r("code",[e._v("--mount type=bind")]),e._v("）、Volume（"),r("code",[e._v("--mount type=volume")]),e._v("）和 tmpfs（"),r("code",[e._v("--mount type=tmpfs")]),e._v("），如图 13-1 所示。其中 tmpfs 用于在内存中读写临时数据，与本节主要讨论的对象持久化存储并不相符，所以后面我们只着重关注 Bind 和 Volume 两种挂载类型。")]),e._v(" "),r("div",{staticClass:"custom-block center"},[r("p",[r("img",{attrs:{src:s(494),alt:""}}),e._v("\n图 13-1 Docker 的三种挂载类型（图片来自"),r("a",{attrs:{href:"https://docs.docker.com/storage/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker 官网文档"),r("OutboundLink")],1),e._v("）")])]),e._v(" "),r("p",[e._v("Bind Mount 是 Docker 最早提供的（发布时就支持）挂载类型，作用是把宿主机的某个目录（或文件）挂载到容器的指定目录（或文件）下，譬如以下命令中参数"),r("code",[e._v("-v")]),e._v("表达的意思就是将外部的 HTML 文档挂到 Nginx 容器的默认网站根目录下：")]),e._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[e._v("docker run -v /icyfenix/html:/usr/share/nginx/html nginx:latest\n")])])]),r("p",[e._v("请注意，虽然命令中"),r("code",[e._v("-v")]),e._v("参数是"),r("code",[e._v("--volume")]),e._v("的缩写，但"),r("code",[e._v("-v")]),e._v("最初只是用来创建 Bind Mount 而不是创建 Volume Mount 的，这种迷惑的行为也并非 Docker 的本意，只是由于 Docker 刚发布时考虑得不够周全，随随便便就在参数中占用了“Volume”这个词，到后来真的需要扩展 Volume 的概念来支持 Volume Mount 时，前面的"),r("code",[e._v("-v")]),e._v("已经被用户广泛使用了，所以也就只得如此将就着继续用。从 Docker 17.06 版本开始，它在 Docker Swarm 中借用了"),r("code",[e._v("--mount")]),e._v("参数过来，这个参数默认创建的是 Volume Mount，可以通过明确的 type 子参数来指定另外两种挂载类型。上面命令可以等价于"),r("code",[e._v("--mount")]),e._v("版本如下形式：")]),e._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[e._v("docker run --mount "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("type")]),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("bind,source"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/icyfenix/html,destination"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/usr/share/nginx/html nginx:latest\n")])])]),r("p",[e._v("从 Bind Mount 到 Volume Mount，实质是容器发展过程中对存储抽象能力提升的外在表现。从“Bind”这个名字，以及 Bind Mount 的实际功能可以合理地推测，Docker 最初认为“Volume”就只是一种“外部宿主机的磁盘存储到内部容器存储的映射关系”，但后来眉头一皱发现事情并没有那么简单：存储的位置并不局限只在外部宿主机、存储的介质并不局限只是物理磁盘、存储的管理也并不局限只有映射关系。")]),e._v(" "),r("p",[e._v("譬如，Bind Mount 只能让容器与本地宿主机之间建立了某个目录的映射，如果想要在不同宿主机上的容器共享同一份存储，就必须先把共享存储挂载到每一台宿主机操作系统的某个目录下，然后才能逐个挂载到容器内使用，这种跨宿主机共享存储的场景如图 13-2 所示。")]),e._v(" "),r("div",{staticClass:"custom-block center"},[r("p",[r("img",{attrs:{src:s(495),alt:""}}),e._v("\n图 13-2 跨主机的共享存储需求（图片来自"),r("a",{attrs:{href:"https://docs.docker.com/storage/volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker 官网文档"),r("OutboundLink")],1),e._v("）")])]),e._v(" "),r("p",[e._v("这种存储范围超越了宿主机的共享存储，配置过程却要涉及到大量与宿主机环境相关的操作，只能由管理员人工去完成，不仅烦琐，而且每台宿主机环境的差异导致还很难自动化。")]),e._v(" "),r("p",[e._v("又譬如即便只考虑单台宿主机的情况，基于可管理性的需求，Docker 也完全有支持 Volume Mount 的必要。Bind Mount 的设计里，Docker 只有容器的控制权，存放容器生产数据的主机目录是完全独立的，与 Docker 没有任何关系，既不受 Docker 保护，也不受 Docker 管理。数据很容易被其他进程访问到，甚至是被修改和删除。如果用户想对挂载的目录进行备份、迁移等管理运维操作，也只能在 Docker 之外靠管理员人工进行，这都增加了数据安全与操作意外的风险。因此，Docker 希望能有一种抽象的资源来代表在宿主机或网络中存储的区域，以便让 Docker 能管理这些资源，由此就很自然地联想到了操作系统里 Volume 的概念。")]),e._v(" "),r("p",[e._v("最后，提出 Volume 最核心的一个目的是为了提升 Docker 对不同存储介质的支撑能力，这同时也是为了减轻 Docker 本身的工作量。存储并不是仅有挂载在宿主机上的物理存储这一种介质，云计算时代，网络存储渐成数据中心的主流选择，不同的网络存储有各自的协议和交互接口，而且并非所有存储系统都适合先挂载到操作系统，然后再挂载到容器的，如果 Docker 想要越过操作系统去支持挂载某种存储系统，首先必须要知道该如何访问它，然后才能将容器中的读写操作自动转移到该位置。Docker 把解决如何访问存储的功能模块称为存储驱动（Storage Driver）。通过"),r("code",[e._v("docker info")]),e._v("命令，你能查看到当前 Docker 所支持的存储驱动。虽然 Docker 已经内置了市面上主流的 OverlayFS 驱动，譬如 Overlay、Overlay2、AUFS、BTRFS、ZFS，等等，但面对云计算的快速迭代，仅靠 Docker 自己来支持全部云计算厂商的存储系统是完全不现实的，为此，Docker 提出了与 Storage Driver 相对应的 Volume Driver（卷驱动）的概念。用户可以通过"),r("code",[e._v("docker plugin install")]),e._v("命令安装"),r("a",{attrs:{href:"https://docs.docker.com/engine/extend/legacy_plugins/",target:"_blank",rel:"noopener noreferrer"}},[e._v("外部的卷驱动"),r("OutboundLink")],1),e._v("，并在创建 Volume 时指定一个与其存储系统相匹配的卷驱动，譬如希望数据存储在 AWS Elastic Block Store 上，就找一个 AWS EBS 的驱动，如果想存储在 Azure File Storage 上，也是找一个对应的 Azure File Storage 驱动即可。如果创建 Volume 时不指定卷驱动，那默认就是 local 类型，在 Volume 中存放的数据会存储在宿主机的"),r("code",[e._v("/var/lib/docker/volumes/")]),e._v("目录之中。")]),e._v(" "),r("h2",{attrs:{id:"静态存储分配"}},[e._v("静态存储分配")]),e._v(" "),r("p",[e._v("现在我们把讨论主角转回容器编排系统上。Kubernetes 同样将操作系统和 Docker 的 Volume 概念延续了下来，并且对其进一步细化。Kubernetes 将 Volume 分为持久化的 PersistentVolume 和非持久化的普通 Volume 两类。为了不与前面定义的 Volume 这个概念产生混淆，后面特指 Kubernetes 中非持久化的 Volume 时，都会带着“普通”前缀。")]),e._v(" "),r("p",[e._v("普通 Volume 的设计目标不是为了持久地保存数据，而是为同一个 Pod 中多个容器提供可共享的存储资源，因此 Volume 具有十分明确的生命周期——与挂载它的 Pod 相同的生命周期，这意味着尽管普通 Volume 不具备持久化的存储能力，但至少比 Pod 中运行的任何容器的存活期都更长，Pod 中不同的容器能共享相同的普通 Volume，当容器重新启动时，普通 Volume 中的数据也会能够得到保留。当然，一旦整个 Pod 被销毁，普通 Volume 也将不复存在，数据在逻辑上也会被销毁掉，至于实质上会否会真正删除数据，就取决于存储驱动具体是如何实现 Unmount、Detach、Delete 接口的，由于本节的主题为“持久化存储”，所以无持久化能力的普通 Volume 就不再展开了。")]),e._v(" "),r("p",[e._v("从操作系统里传承下来的 Volume 概念，在 Docker 和 Kubernetes 中继续按照一致的逻辑延伸拓展，只不过 Kubernetes 为将其与普通 Volume 区别开来，专门取了 PersistentVolume 这个名字，你可以从从图 13-3 中直观地看出普通 Volume、PersistentVolume 和 Pod 之间的关系差异。")]),e._v(" "),r("div",{staticClass:"custom-block center"},[r("p",[r("img",{attrs:{src:s(496),alt:""}}),e._v("\n图 13-3 普通 Volume 与 PersistentVolume 的差别")])]),e._v(" "),r("p",[e._v("从“Persistent”这个单词就能顾名思义，PersistentVolume 是指能够将数据进行持久化存储的一种资源对象，它可以独立于 Pod 存在，生命周期与 Pod 无关，因此也决定了 PersistentVolume 不应该依附于任何一个宿主机节点，否则必然会对 Pod 调度产生干扰限制。前面表 13-1 中“Persistent”一列里看到的都是网络存储便是很好的印证。")]),e._v(" "),r("div",{staticClass:"quote"},[r("p",{staticClass:"title"},[e._v("额外知识：Local PersistentVolume")]),r("p",[e._v("对于部署在云端数据中心的系统，通过网络访问同一个可用区中的远程存储，速度是完全可以接受的。但对于私有部署的系统，基于性能考虑，使用本地存储往往会更为常见。")]),e._v(" "),r("p",[e._v("考虑到这样的实际需求，从 1.10 版起，Kubernetes 开始支持"),r("a",{attrs:{href:"https://kubernetes.io/blog/2019/04/04/kubernetes-1.14-local-persistent-volumes-ga/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Local PersistentVolume"),r("OutboundLink")],1),e._v("，这是一种将一整块本地磁盘作为 PersistentVolume 供容器使用的专用方案。“专用方案”就是字面意思，它并不适用于全部应用，Local PersistentVolume 只是针对以磁盘 I/O 为瓶颈的特定场景的解决方案，副作用十分明显：由于不能保证这种本地磁盘在每个节点中都一定存在，所以 Kubernetes 在调度时就必须考虑到 PersistentVolume 分布情况，只能把使用了 Local PersistentVolume 的 Pod 调度到有这种 PersistentVolume 的节点上。调度器中专门有个"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/storage-classes/#volume-binding-mode",target:"_blank",rel:"noopener noreferrer"}},[e._v("Volume Binding Mode"),r("OutboundLink")],1),e._v("模式来支持这项处理，尽管如此，一旦使用了 Local PersistentVolume，无疑是会限制 Pod 的可调度范围。")])]),r("p",[e._v("将 PersistentVolume 与 Pod 分离后，便需要专门考虑 PersistentVolume 该如何被 Pod 所引用的问题。原本在 Pod 中引用其他资源是常有的事，要么直接通过资源名称直接引用，要么通过"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/",target:"_blank",rel:"noopener noreferrer"}},[e._v("标签选择器"),r("OutboundLink")],1),e._v("（Selectors）间接引用。但是类似的方法在这里却都不太妥当，至于原因，请你想一下“Pod 该使用何种存储”这件事情，应该是系统管理员（运维人员）说的算，还是由用户（开发人员）说的算？最合理的答案是他们一起说的才算，因为只有开发能准确评估 Pod 运行需要消耗多大的存储空间，只有运维能清楚知道当前系统可以使用的存储设备状况，为了让他们得以各自提供自己擅长的信息，Kubernetes 又额外设计出了 PersistentVolumeClaim 资源。Kubernetes 官方给出的概念定义也特别强调了 PersistentVolume 是由管理员（运维人员）负责维护的，用户（开发人员）通过 PersistentVolumeClaim 来匹配到合乎需求的 PersistentVolume。")]),e._v(" "),r("div",{staticClass:"quote"},[r("p",{staticClass:"title"},[e._v("PersistentVolume & PersistentVolumeClaim")]),r("p",[e._v("A PersistentVolume （PV） is a piece of storage in the cluster that has been provisioned "),r("strong",[e._v("by an administrator")]),e._v(". "),r("br"),e._v("A PersistentVolumeClaim （PVC） is a request for storage "),r("strong",[e._v("by a user")]),e._v(".")]),e._v(" "),r("p",[e._v("PersistentVolume 是由管理员负责提供的集群存储。"),r("br"),e._v("PersistentVolumeClaim 是由用户负责提供的存储请求。")]),e._v(" "),r("div",{staticClass:"custom-block right"},[r("p",[e._v("—— Kubernetes Reference Documentation，"),r("a",{attrs:{href:"https://jamesdefabia.github.io/docs/user-guide/persistent-volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Persistent Volumes"),r("OutboundLink")],1)])])]),r("p",[e._v("PersistentVolume 是 Volume 这个抽象概念的具象化表现，通俗地说就它是已经被管理员分配好的具体的存储，这里的“具体”是指有明确的存储系统地址，有明确的容量、访问模式、存储位置等信息；而 PersistentVolumeClaim 则是 Pod 对其所需存储能力的声明，通俗地说就是满足这个 Pod 正常运行要满足怎样的条件，譬如要消耗多大的存储空间、要支持怎样的访问方式。因此两者并不是谁引用谁的固定关系，而是根据实际情况动态匹配的，两者配合工作的具体过程如下。")]),e._v(" "),r("ol",[r("li",[e._v("管理员准备好要使用的存储系统，它应是某种网络文件系统（NFS）或者云储存系统，一般来说应该具备跨主机共享的能力。")]),e._v(" "),r("li",[e._v("管理员根据存储系统的实际情况，手工预先分配好若干个 PersistentVolume，并定义好每个 PersistentVolume 可以提供的具体能力。譬如以下例子所示："),r("div",{staticClass:"language-yaml extra-class"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" PersistentVolume\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("html\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("capacity")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("storage")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" 5Gi                          "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 最大容量为5GB")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("accessModes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" ReadWriteOnce                       "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 访问模式为RWO")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("persistentVolumeReclaimPolicy")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Retain\t  "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 回收策略是Retain")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("nfs")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("                                    "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 存储驱动是NFS")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("path")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" /html\n    "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("server")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" 172.17.0.2\n")])])]),e._v("以上 YAML 中定义的存储能力具体为：\n"),r("ul",[r("li",[e._v("存储的最大容量是 5GB。")]),e._v(" "),r("li",[e._v("存储的访问模式是“只能被一个节点读写挂载”（ReadWriteOnce，RWO），另外两种可选的访问模式是“可以被多个节点以只读方式挂载”（ReadOnlyMany，ROX）和“可以被多个节点读写挂载”（ReadWriteMany，RWX）。")]),e._v(" "),r("li",[e._v("存储的回收策略是 Retain，即在 Pod 被销毁时并不会删除数据。另外两种可选的回收策略分别是 Recycle ，即在 Pod 被销毁时，由 Kubernetes 自动执行"),r("code",[e._v("rm -rf /volume/*")]),e._v("这样的命令来自动删除资料；以及 Delete，它让 Kubernetes 自动调用 AWS EBS、GCE PersistentDisk、OpenStack Cinder 这些云存储的删除指令。")]),e._v(" "),r("li",[e._v("存储驱动是 NFS，其他常见的存储驱动还有 AWS EBS、GCE PD、iSCSI、RBD（Ceph Block Device）、GlusterFS、HostPath，等等。")])])]),e._v(" "),r("li",[e._v("用户根据业务系统的实际情况，创建 PersistentVolumeClaim，声明 Pod 运行所需的存储能力。譬如以下例子所示："),r("div",{staticClass:"language-yaml extra-class"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" PersistentVolumeClaim\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("html"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("claim\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("accessModes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" ReadWriteOnce    "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 支持RWO访问模式")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resources")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("requests")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("storage")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" 5Gi     "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 最小容量5GB")]),e._v("\n")])])]),e._v("以上 YAML 中声明了要求容量不得小于 5GB，必须支持 RWO 的访问模式。")]),e._v(" "),r("li",[e._v("Kubernetes 创建 Pod 的过程中，会根据系统中 PersistentVolume 与 PersistentVolumeClaim 的供需关系对两者进行撮合，如果系统中存在满足 PersistentVolumeClaim 声明中要求能力的 PersistentVolume 则撮合成功，将它们绑定。如果撮合不成功，Pod 就不会被继续创建，直至系统中出现新的或让出空闲的 PersistentVolume 资源。")]),e._v(" "),r("li",[e._v("以上几步都顺利完成的话，意味着 Pod 的存储需求得到满足，继续 Pod 的创建过程，整个过程如图 13-4 所示。")])]),e._v(" "),r("div",{staticClass:"custom-block center"},[r("p",[r("img",{attrs:{src:s(497),alt:""}}),e._v("\n图 13-4 PersistentVolumeClaim 与 PersistentVolume 运作过程（图片来自《"),r("a",{attrs:{href:"https://www.manning.com/books/kubernetes-in-action",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes in Action"),r("OutboundLink")],1),e._v("》）")])]),e._v(" "),r("p",[e._v("Kubernetes 对 PersistentVolumeClaim 与 PersistentVolume 撮合的结果是产生一对一的绑定关系，“一对一”的意思是 PersistentVolume 一旦绑定在某个 PersistentVolumeClaim 上，直到释放以前都会被这个 PersistentVolumeClaim 所独占，不能再与其他 PersistentVolumeClaim 进行绑定。这意味着即使 PersistentVolumeClaim 申请的存储空间比 PersistentVolume 能够提供的要少，依然要求整个存储空间都为该 PersistentVolumeClaim 所用，这有可能会造成资源的浪费。譬如，某个 PersistentVolumeClaim 要求 3GB 的存储容量，当前 Kubernetes 手上只剩下一个 5GB 的 PersistentVolume 了，此时 Kubernetes 只好将这个 PersistentVolume 与申请资源的 PersistentVolumeClaim 进行绑定，平白浪费了 2GB 空间。假设后续有另一个 PersistentVolumeClaim 申请 2GB 的存储空间，那它也只能等待管理员分配新的 PersistentVolume，或者有其他 PersistentVolume 被回收之后才被能成功分配。")]),e._v(" "),r("h2",{attrs:{id:"动态存储分配"}},[e._v("动态存储分配")]),e._v(" "),r("p",[e._v("对于中小规模的 Kubernetes 集群，PersistentVolume 已经能够满足有状态应用的存储需求，PersistentVolume 依靠人工介入来分配空间的设计算是简单直观，却算不上是先进，一旦应用规模增大，PersistentVolume 很难被自动化的问题就会突显出来。这是由于 Pod 创建过程中去挂载某个 Volume，要求该 Volume 必须是真实存在的，否则 Pod 启动可能依赖的数据（如一些配置、数据、外部资源等）都将无从读取。Kubernetes 有能力随着流量压力和硬件资源状况，自动扩缩 Pod 的数量，但是当 Kubernetes 自动扩展出一个新的 Pod 后，并没有办法让 Pod 去自动挂载一个还未被分配资源的 PersistentVolume。想解决这个问题，要么允许多个不同的 Pod 都共用相同的 PersistentVolumeClaim，这种方案确实只靠 PersistentVolume 就能解决，却损失了隔离性，难以通用；要么就要求每个 Pod 用到的 PersistentVolume 都是已经被预先建立并分配好的，这种方案靠管理员提前手工分配好大量的存储也可以实现，却损失了自动化能力。")]),e._v(" "),r("p",[e._v("无论哪种情况，都难以符合 Kubernetes 工业级编排系统的产品定位，对于大型集群，面对成百上千，乃至成千上万的 Pod，靠管理员手工分配存储肯定是捉襟见肘疲于应付的。在 2017 年 Kubernetes 发布 1.6 版本后，终于提供了今天被称为动态存储分配（Dynamic Provisioning）的解决方案，让系统管理员摆脱了人工分配的 PersistentVolume 的窘境，与之相对，人们把此前的分配方式称为静态存储分配（Static Provisioning）。")]),e._v(" "),r("p",[e._v("所谓的动态存储分配方案，是指在用户声明存储能力的需求时，不是期望通过 Kubernetes 撮合来获得一个管理员人工预置的 PersistentVolume，而是由特定的资源分配器（Provisioner）自动地在存储资源池或者云存储系统中分配符合用户存储需要的 PersistentVolume，然后挂载到 Pod 中使用，完成这项工作的资源被命名为 StorageClass，它的具体工作过程如下：")]),e._v(" "),r("ol",[r("li",[e._v("管理员根据存储系统的实际情况，先准备好对应的 Provisioner。Kubernetes 官方已经提供了一系列"),r("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/storage-classes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("预置的 In-Tree Provisioner"),r("OutboundLink")],1),e._v("，放置在"),r("code",[e._v("kubernetes.io")]),e._v("的 API 组之下。其中部分 Provisioner 已经有了官方的 CSI 驱动，譬如 vSphere 的 Kubernetes 自带驱动为"),r("code",[e._v("kubernetes.io/vsphere-volume")]),e._v("，VMware 的官方驱动为"),r("code",[e._v("csi.vsphere.vmware.com")]),e._v("。")]),e._v(" "),r("li",[e._v("管理员不再是手工去分配 PersistentVolume，而是根据存储去配置 StorageClass。Pod 是可以动态扩缩的，而存储则是相对固定的，哪怕使用的是具有扩展能力的云存储，也会将它们视为存储容量、IOPS 等参数可变的固定存储来看待，譬如你可以将来自不同云存储提供商、不同性能、支持不同访问模式的存储配置为各种类型的 StorageClass，这也是它名字中“Class”（类型）的由来，譬如以下例子所示："),r("div",{staticClass:"language-yaml extra-class"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" storage.k8s.io/v1\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" StorageClass\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" standard\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("provisioner")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" kubernetes.io/aws"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("ebs  "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#AWS EBS的Provisioner")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("parameters")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" gp2\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("reclaimPolicy")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Retain\n")])])])]),e._v(" "),r("li",[e._v("用户依然通过 PersistentVolumeClaim 来声明所需的存储，但是应在声明中明确指出该由哪个 StorageClass 来代替 Kubernetes 处理该 PersistentVolumeClaim 的请求，譬如以下例子所示："),r("div",{staticClass:"language-yaml extra-class"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" PersistentVolumeClaim\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" standard"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("claim\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("accessModes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" ReadWriteOnce\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("storageClassName")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" standard  "),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#明确指出该由哪个StorageClass来处理该PersistentVolumeClaim的请求")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("resource")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("requests")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("storage")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" 5Gi\n")])])])]),e._v(" "),r("li",[e._v("如果 PersistentVolumeClaim 中要求的 StorageClass 及它用到的 Provisioner 均是可用的话，那这个 StorageClass 就会接管掉原本由 Kubernetes 撮合 PersistentVolume 与 PersistentVolumeClaim 的操作，按照 PersistentVolumeClaim 中声明的存储需求，自动产生出满足该需求的 PersistentVolume 描述信息，并发送给 Provisioner 处理。")]),e._v(" "),r("li",[e._v("Provisioner 接收到 StorageClass 发来的创建 PersistentVolume 请求后，会操作其背后存储系统去分配空间，如果分配成功，就生成并返回符合要求的 PersistentVolume 给 Pod 使用。")]),e._v(" "),r("li",[e._v("以上几步都顺利完成的话，意味着 Pod 的存储需求得到满足，继续 Pod 的创建过程，整个过程如图 13-5 所示。")])]),e._v(" "),r("div",{staticClass:"custom-block center"},[r("p",[r("img",{attrs:{src:s(498),alt:""}}),e._v("\n图 13-5 StorageClass 运作过程（图片来自《"),r("a",{attrs:{href:"https://www.manning.com/books/kubernetes-in-action",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes in Action"),r("OutboundLink")],1),e._v("》）")])]),e._v(" "),r("p",[e._v("Dynamic Provisioning 与 Static Provisioning 并不是各有用途的互补设计，而是对同一个问题先后出现的两种解决方案。你完全可以只用 Dynamic Provisioning 来实现所有的 Static Provisioning 能够实现的存储需求，包括那些不需要动态分配的场景，甚至之前例子里使用 HostPath 在本地静态分配存储，都可以指定"),r("code",[e._v("no-provisioner")]),e._v("作为 Provisioner 的 StorageClass，以 Local Persistent Volume 来代替，譬如以下例子所示：")]),e._v(" "),r("div",{staticClass:"language-yaml extra-class"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" storage.k8s.io/v1\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" StorageClass\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" local"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("storage\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("provisioner")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" kubernetes.io/no"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("provisioner\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumeBindingMode")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" WaitForFirstConsumer\n")])])]),r("p",[e._v("使用 Dynamic Provisioning 来分配存储无疑是更合理的设计，不仅省去了管理员的人工操作的中间层，也不再需要将 PersistentVolume 这样的概念暴露给最终用户，因为 Dynamic Provisioning 里的 PersistentVolume 只是处理过程的中间产物，用户不再需要接触和理解它，只需要知道由 PersistentVolumeClaim 去描述存储需求，由 StorageClass 去满足存储需求即可。只描述意图而不关心中间具体的处理过程是声明式编程的精髓，也是流程自动化的必要基础。")]),e._v(" "),r("p",[e._v("由 Dynamic Provisioning 来分配存储还能获得更高的可管理性，譬如前面提到的回收策略，当希望 PersistentVolume 跟随 Pod 一同被销毁时，以前经常会配置回收策略为 Recycle 来回收空间，即让系统自动执行"),r("code",[e._v("rm -rf /volume/*")]),e._v("命令，这种方式往往过于粗暴，遇到更精细的管理需求，譬如“删除到回收站”或者“敏感信息粉碎式彻底删除”这样的功能实现起来就很麻烦。而 Dynamic Provisioning 中由于有 Provisioner 的存在，如何创建、如何回收都是由 Provisioner 的代码所管理的，这就带来了更高的灵活性。现在 Kubernetes 官方已经明确建议废弃掉 Recycle 策略，如有这类需求就应改由 Dynamic Provisioning 去实现了。")]),e._v(" "),r("p",[e._v("Static Provisioning 的主要使用场景已局限于管理员能够手工管理存储的小型集群，它符合很多小型系统，尤其是私有化部署系统的现状，但并不符合当今运维自动化所提倡的思路。Static Provisioning 的存在，某种意义上也可以视为是对历史的一种兼容，在可见的将来，Kubernetes 肯定仍会把 Static Provisioning 作为用户分配存储的一种主要方案供用户选用。")])])}),[],!1,null,null,null);t.default=n.exports}}]);